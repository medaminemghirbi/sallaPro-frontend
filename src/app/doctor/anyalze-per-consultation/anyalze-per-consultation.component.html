<div class="content container-fluid">

  <div class="row">
    <!-- Section d'analyse -->
    <div class="col-md-5 mb-4">
      <div class="card shadow-sm bg-light border-0">

        <h4 class="card-header text-center bg-primary text-white">
          {{ 'Doctor_IA_section.title' | translate }}
        </h4>
        <form [formGroup]="imageupdate" #f="ngForm" (ngSubmit)="updateimage(f)" class="p-4">
          <!-- Input de fichier -->
          <div class="form-group mb-3 text-center">
            <input type="file" class="form-control form-control-lg" (change)="fileChange($event)" accept="image/*"
              formControlName="file" required />
          </div>
          <!-- Aperçu de l'image téléchargée -->
          <div *ngIf="imageUrl" class="text-center mb-3">
            <img [src]="imageUrl" alt="Uploaded Image" class="img-fluid border" width="300"
              style="border-radius: 8px;">
          </div>

          <!-- Bouton de soumission -->
          <div class="text-center">
            <button type="submit" class="btn btn-success btn-lg">
              {{ 'Doctor_IA_section.processing_image' | translate }}
            </button>
          </div>

          <!-- Indicateur de chargement -->
          <div *ngIf="loading" class="loading-indicator text-center mt-4">
            <p class="text-secondary">{{ 'Doctor_IA_section.processing_image' | translate }}</p>
          </div>
        </form>
      </div>
    </div>

<!-- Section des résultats (6 colonnes au lieu de 4) -->
<div class="col-md-6 mb-4" *ngIf="result">
  <div class="card shadow-sm bg-white border-0">
    <h4 class="card-header text-center bg-info text-white">
      {{ 'Doctor_IA_section.prediction_result.header' | translate }}
    </h4>

    <div *ngIf="result && !loading" class="result-display p-4">
      <!-- Résumé de la prédiction -->
      <div class="row mb-4 text-center">
        <div class="col-md-6 mb-3">
          <p><strong>{{ 'Doctor_IA_section.prediction_result.predicted_class' | translate }}</strong></p>
          <span class="badge bg-primary fs-5 px-3 py-2">{{ result.predicted_class }}</span>
        </div>
        <div class="col-md-6 mb-3">
          <p><strong>{{ 'Doctor_IA_section.prediction_result.probability' | translate }}</strong></p>
          <span class="badge bg-success fs-5 px-3 py-2">{{ result.probability | number:'1.2-2' }}%</span>
        </div>
      </div>

      <hr>

      <!-- Informations détaillées -->
      <div class="row gy-3">
        <ng-container *ngFor="let item of [
          { label: 'is_cancer', value: result.maladie.is_cancer ? ('Doctor_IA_section.prediction_result.yes' | translate) : ('Doctor_IA_section.prediction_result.no' | translate), isCancer: true },
          { label: 'causes', value: result.maladie.causes },
          { label: 'symptoms', value: result.maladie.symptoms },
          { label: 'synonyms', value: result.maladie.synonyms },
          { label: 'prevention', value: result.maladie.prevention },
          { label: 'treatment', value: result.maladie.treatments }
        ]">
          <div class="col-4 fw-bold">
            {{ 'Doctor_IA_section.prediction_result.' + item.label | translate }}
          </div>
          <div class="col-8" [ngClass]="item.isCancer ? (result.maladie.is_cancer ? 'text-danger' : 'text-success') : ''">
            {{ item.value }}
          </div>
        </ng-container>

        <!-- Références -->
        <div class="col-4 fw-bold">
          {{ 'Doctor_IA_section.prediction_result.reference' | translate }}
        </div>
        <div class="col-8">
          <a href="{{ result.maladie.references }}" target="_blank" class="text-primary">
            {{ 'Doctor_IA_section.prediction_result.view_source' | translate }}
          </a>
        </div>

        <!-- Rapport PDF -->
        <div class="col-4 fw-bold">
          {{ 'Doctor_IA_section.prediction_result.download' | translate }}
        </div>
        <div class="col-8">
          <a href="{{ result.report_url }}" target="_blank" class="text-primary">
            {{ 'Doctor_IA_section.prediction_result.download_report' | translate }}
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

  </div>
</div>