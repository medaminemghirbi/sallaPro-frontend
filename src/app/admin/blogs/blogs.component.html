<div class="main-wrapper">
    <app-header-admin></app-header-admin>
    <app-sidebar-admin></app-sidebar-admin>
    <ng-progress #progressBar></ng-progress>
    <div class="page-wrapper">
        <div class="content">
            <div class="card">
                <div class="card-header d-flex align-items-center justify-content-between">

                    <!-- Search input on the left -->
                    <div class="search-bar">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Search blogs..." [(ngModel)]="searchText">
                            <button class="btn btn-outline-secondary" type="button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                
                    <!-- Two selects on the right -->
                    <div class="d-flex align-items-center">
                        <!-- Items per page select -->
                        <div class="form-group me-3 mb-0">
                            <select class="form-select" [(ngModel)]="itemsPerPage">
                                <option [value]="5">5</option>
                                <option [value]="25">25</option>
                                <option [value]="100">100</option>
                            </select>
                        </div>
                
                        <!-- Filter by verification status select -->
                        <div class="form-group mb-0">
                            <select class="form-select" [(ngModel)]="filterVerified">
                                <option [value]="''">All</option>
                                <option [value]="'true'">Verified</option>
                                <option [value]="'false'">Pending</option>
                            </select>
                        </div>
                    </div>
                
                </div>
                
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="thead-light">
                                <tr>
                                    <th width="5%">#</th>
                                    <th width="15%">Doctor</th>
                                    <th width="20%">Title</th>
                                    <th width="30%">Content Preview</th>
                                    <th width="10%">Date</th>
                                    <th width="10%">Status</th>
                                    <th width="10%">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of allBlogs 
                                | paginate: { itemsPerPage: itemsPerPage, currentPage: p } 
                                | filter: searchText 
                                | filterByVerification: filterVerified; index as i"
                                    [ngClass]="{'table-warning': !item.is_verified, 'table-success': item.is_verified}">
                                    <td>{{i + 1}}</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img class="rounded-circle me-2" src="{{item.doctor.user_image_url}}" 
                                                 width="40" height="40" alt="Doctor">
                                            <div>
                                                <h6 class="mb-0">Dr. {{item.doctor.firstname}} {{item.doctor.lastname}}</h6>
                                                <small class="text-muted">Dermatology</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <a [routerLink]="['/blog', item.id]" class="text-primary fw-bold">
                                            {{item.title}}
                                        </a>
                                    </td>
                                    <td>{{item.content}}</td>
                                    <td>{{ item.created_at | date:'dd MMM yyyy' }}</td>
                                    <td>
                                        <span class="badge rounded-pill" 
                                              [ngClass]="{'bg-warning text-dark': !item.is_verified, 'bg-success': item.is_verified}">
                                            {{item.is_verified ? 'Verified' : 'Pending'}}
                                        </span>
                                    </td>
                                    <td>
                                        <div class="dropdown">
                                            <button class="btn btn-sm btn-outline-secondary dropdown-toggle" 
                                                    type="button" data-bs-toggle="dropdown">
                                                <i class="fas fa-ellipsis-v"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a class="dropdown-item" [routerLink]="['/blog', item.id]">
                                                        <i class="fas fa-eye me-2"></i>View
                                                    </a>
                                                </li>
                                                <li *ngIf="!item.is_verified">
                                                    <a class="dropdown-item" (click)="AddVerification(item.id, i)">
                                                        <i class="fas fa-check-circle me-2 text-success"></i>Verify
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="text-align:right;">
                        <pagination-controls (pageChange)="p = $event"></pagination-controls>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>